import{n as K,m as Q,c as X}from"./colors-inGVzw7t.js";import{_ as f}from"./FormField-CILI8Nf7.js";import{_ as d}from"./FormControl-bDY0Yb_I.js";import{C as G}from"./CardBoxComponentEmpty-CtyqEEwp.js";import{_ as H}from"./BaseButtons-D7HU0kj1.js";import{_ as N}from"./BaseButton-sgO_vKHC.js";import{_ as g}from"./InputError-B-EUtzjq.js";import{c as w,o as i,a as c,l as J,t as x,h as b,u as a,j as v,q as W,x as B,Q as Y,r as E,w as Z,z as ee,b as r,d as _,e as o,F as A,g as T,k as j}from"./app-DdNFHAqW.js";import{_ as te}from"./Select-BJN33FS9.js";import{S as I}from"./sweetalert2.esm.all-BccGxJ0c.js";/* empty css                        */import"./main-B-O7UoXT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_baseGetTag-Ddn2H9e8.js";const y={__name:"LabelControl",props:{value:{type:[String,Number,Array],default:null},height:{type:String,default:"h-12"},disabled:{type:Boolean,default:!1},canCopy:{type:Boolean,default:!1}},setup(k){const e=k,C=w(()=>["shadow-none rounded-md px-2 py-2.5 border overflow-auto relative",e.disabled?"bg-gray-300 text-slate-900 dark:bg-gray-600 dark:text-white border-gray-500 cursor-not-allowed":"border-gray-400 dark:border-gray-600 rounded dark:placeholder-gray-400 bg-white dark:bg-slate-800",e.height]),m=()=>{if(e.value)if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(e.value);else{const p=document.createElement("textarea");p.value=e.value,p.style.position="absolute",p.style.opacity="0",document.body.appendChild(p),p.select(),document.body.removeChild(p)}};return(p,U)=>(i(),c("div",{class:W(C.value)},[J(x(k.value)+" ",1),k.canCopy?(i(),b(N,{key:0,title:"Copiar en el portapapeles",class:"absolute top-1 right-1",color:"transparent",icon:a(K),small:"",onClick:m},null,8,["icon"])):v("",!0)],2))}},le={class:"md:flex md:space-x-4 my-5"},oe={class:"md:w-1/2 max-lg:mb-5"},ae={class:"md:w-1/2"},re={class:"my-6"},se={class:"justify-between flex mb-6"},ie={class:"max-h-96 overflow-y-auto overflow-x-auto"},ne={key:0,class:""},de={key:0},ue={key:0},me={"data-label":"No"},ce={"data-label":"AC"},pe=["checked"],_e={"data-label":"Prefijo"},fe={"data-label":"Nombre(s)"},he={"data-label":"Apellido(s)"},be={"data-label":"Institución"},ge={"data-label":"Email"},ye={"data-label":"Acciones"},xe={key:1},ve={"data-label":"No"},ke={"data-label":"AC"},Ve=["checked"],we={"data-label":"Prefijo"},Ce={"data-label":"Nombre(s)"},Ue={"data-label":"Apellido(s)"},Ae={"data-label":"Institución"},Ne={"data-label":"Email"},Pe={class:"bg-slate-100 border-4 border-dashed border-gray-400 flex flex-col items-center justify-center rounded-lg shadow-lg p-6 md:p-10 mb-4 dark:bg-gray-800 dark:border-gray-600"},Se={class:"w-auto mb-6 text-sm md:text-base font-medium text-gray-700 dark:text-gray-300"},Be={class:"flex justify-center space-x-2"},Ee={class:"font-semibold mt-4"},Te={class:"font-semibold"},je={class:"w-full flex justify-center mt-8 mb-4"},Ie=["src"],Je={__name:"Article",setup(k){var S;const e=B("form"),C=Y().props.articleTypes,m=B("props");e.article_type_id=e.article_type_id??((S=m.article)==null?void 0:S.article_type_id)??null;const p=m.areas.filter(s=>s.parent_id===null)??[],U=E([]),V=E(m.institutions),$=w(()=>{var s,t;return((s=e.file)==null?void 0:s.name)??((t=m.article.file)==null?void 0:t.name)??"Sin archivo"}),q=w(()=>{var s,t;return((((s=e.file)==null?void 0:s.size)??((t=m.article.file)==null?void 0:t.size))/1e3).toFixed(2)+" KB"}),L=s=>{e.file=s.target.files[0]},D=w(()=>e.file?URL.createObjectURL(e.file):m.filePath),F=[{id:"Doctor(a)",name:"Doctor(a)"},{id:"Maestro(a)",name:"Maestro(a)"},{id:"Ingeniero(a)",name:"Ingeniero(a)"},{id:"Licenciado(a)",name:"Licenciado(a)"},{id:"Profesor(a)",name:"Profesor(a)"},{id:"Estudiante(a)",name:"Estudiante(a)"}],R=()=>{e.authors.push({is_corresponding:!1,prefix:null,name:null,surname:null,institution_id:null,email:null})},z=(s,t)=>{e.authors.length>0&&(t?j.delete(route("author.destroy",t)).then(l=>{l.status===200&&e.authors.splice(s,1)}).catch(l=>{l.response.status===500&&I.fire({title:"Error",text:"Se produjo un error al eliminar el autor.",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"Ok"})}):e.authors.splice(s,1))},h=(s,t)=>{const l=`authors.${s}.${t}`;return e.errors[l]??null},P=()=>{var s,t;e.selectedArea!==((t=(s=m.article)==null?void 0:s.knowledge_area)==null?void 0:t.parent_id)&&(e.knowledge_area_id=null),U.value=m.areas.filter(l=>l.parent_id===e.selectedArea)},M=s=>{j.get(route("institution.filter",s)).then(t=>{V.value=t.data,console.log(V)}).catch(function(t){t.response&&t.response.status==500&&I.fire({title:"ERRO!",text:"Error",icon:"info",confirmButtonColor:"#3085d6",confirmButtonText:"Ok!"})})},O=s=>{var t;return s?(t=V.value)==null?void 0:t.find(l=>l.id===s):null};return Z(()=>e.selectedArea,P),ee(()=>{P()}),(s,t)=>(i(),c(A,null,[r(f,{required:"",label:"Titulo:",error:a(e).errors.title},{default:_(()=>[r(d,{height:"h-12",modelValue:a(e).title,"onUpdate:modelValue":t[0]||(t[0]=l=>a(e).title=l),placeholder:"Titulo"},null,8,["modelValue"])]),_:1},8,["error"]),r(f,{required:"",label:"Tipo de artículo:",error:a(e).errors.article_type_id},{default:_(()=>[r(d,{options:a(C),modelValue:a(e).article_type_id,"onUpdate:modelValue":t[1]||(t[1]=l=>a(e).article_type_id=l),"option-label":"name","option-value":"id",placeholder:"Selecciona un tipo"},null,8,["options","modelValue"])]),_:1},8,["error"]),r(f,{required:"",label:"Resumen:",error:a(e).errors.abstract},{default:_(()=>[r(d,{type:"textarea",height:"h-56",modelValue:a(e).abstract,"onUpdate:modelValue":t[2]||(t[2]=l=>a(e).abstract=l),placeholder:"Resumen"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",le,[o("div",oe,[r(f,{label:"Programa de estudio:"},{default:_(()=>[r(d,{modelValue:a(e).selectedArea,"onUpdate:modelValue":t[3]||(t[3]=l=>a(e).selectedArea=l),options:a(p)},null,8,["modelValue","options"])]),_:1})]),o("div",ae,[r(f,{required:"",label:"Área Prioritaria:",error:a(e).errors.knowledge_area_id},{default:_(()=>[r(d,{modelValue:a(e).knowledge_area_id,"onUpdate:modelValue":t[4]||(t[4]=l=>a(e).knowledge_area_id=l),options:U.value},null,8,["modelValue","options"])]),_:1},8,["error"])])]),r(f,{required:"",label:"Convocatoria:",error:a(e).errors.call_id},{default:_(()=>[r(d,{disabled:"",modelValue:a(e).call,"onUpdate:modelValue":t[5]||(t[5]=l=>a(e).call=l),placeholder:"Convocatoria"},null,8,["modelValue"])]),_:1},8,["error"]),r(f,{required:"",label:"Palabras clave:",error:a(e).errors.key_works},{default:_(()=>[r(d,{modelValue:a(e).key_works,"onUpdate:modelValue":t[6]||(t[6]=l=>a(e).key_works=l),placeholder:"Palabras clave"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",re,[o("div",se,[t[7]||(t[7]=o("label",{class:"font-bold"},"Lista de autores",-1)),a(e)._method?(i(),b(N,{key:0,icon:a(Q),onClick:R,label:"Agregar autor",color:"info"},null,8,["icon"])):v("",!0)]),o("div",ie,[a(e).authors.length>0?(i(),c("table",ne,[o("thead",null,[o("tr",null,[t[8]||(t[8]=o("th",null,"No.",-1)),t[9]||(t[9]=o("th",null,"AC",-1)),t[10]||(t[10]=o("th",null,"Prefijo",-1)),t[11]||(t[11]=o("th",null,"Nombre(s)",-1)),t[12]||(t[12]=o("th",null,"Apellido(s)",-1)),t[13]||(t[13]=o("th",null,"Institución",-1)),t[14]||(t[14]=o("th",null,"Email",-1)),a(e)._method?(i(),c("th",de,"Acciones")):v("",!0)])]),a(e)._method?(i(),c("tbody",ue,[(i(!0),c(A,null,T(a(e).authors,(l,u)=>(i(),c("tr",{key:u},[o("td",me,x(u+1),1),o("td",ce,[o("input",{type:"radio",name:"corresponding-author",checked:l.is_corresponding,class:"h-6 w-6 text-indigo-600"},null,8,pe),r(g,{message:h(u,"prefix")},null,8,["message"])]),o("td",_e,[r(d,{modelValue:l.prefix,"onUpdate:modelValue":n=>l.prefix=n,options:F,height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),r(g,{message:h(u,"prefix")},null,8,["message"])]),o("td",fe,[r(d,{modelValue:l.name,"onUpdate:modelValue":n=>l.name=n,placeholder:"Nombre",height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),r(g,{message:h(u,"name")},null,8,["message"])]),o("td",he,[r(d,{modelValue:l.surname,"onUpdate:modelValue":n=>l.surname=n,placeholder:"Apellido",height:"h-8",textClass:"tex-sm"},null,8,["modelValue","onUpdate:modelValue"]),r(g,{message:h(u,"surname")},null,8,["message"])]),o("td",be,[a(e)._method?(i(),b(f,{key:0,error:h(u,"institution_id"),textClass:"text-sm",class:"dark:text-white"},{default:_(()=>[r(te,{disabled:!a(e)._method,itemSelected:O(l.institution_id),placeholder:"Busca una institución",height:"h-8",modelValue:l.institution_id,"onUpdate:modelValue":n=>l.institution_id=n,required:"",options:V.value,onSearch:M,dropdownClass:"p-2 relative w-full z-50 bg-white dark:bg-gray-800 dark:text-white border border-gray-300 mt-1 max-h-32 overflow-hidden overflow-y-scroll rounded-md shadow-md"},null,8,["disabled","itemSelected","modelValue","onUpdate:modelValue","options"])]),_:2},1032,["error"])):(i(),b(d,{key:1,modelValue:l.institution.name,"onUpdate:modelValue":n=>l.institution.name=n,placeholder:"Institucion",height:"h-8",textClass:"tex-sm"},null,8,["modelValue","onUpdate:modelValue"]))]),o("td",ge,[r(d,{type:"email",modelValue:l.email,"onUpdate:modelValue":n=>l.email=n,placeholder:"Email",height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),r(g,{message:h(u,"email")},null,8,["message"])]),o("td",ye,[r(H,null,{default:_(()=>[r(N,{icon:a(X),small:"",onClick:n=>z(u,l==null?void 0:l.id),color:"danger"},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])):(i(),c("tbody",xe,[(i(!0),c(A,null,T(a(e).authors,(l,u)=>{var n;return i(),c("tr",{key:u},[o("td",ve,x(u+1),1),o("td",ke,[o("input",{type:"radio",name:"corresponding-author",checked:l.is_corresponding,class:"h-6 w-6 text-indigo-600"},null,8,Ve)]),o("td",we,[r(y,{text:"text-xs",value:l.prefix},null,8,["value"])]),o("td",Ce,[r(y,{text:"text-xs",value:l.name},null,8,["value"])]),o("td",Ue,[r(y,{text:"text-xs",value:l.surname},null,8,["value"])]),o("td",Ae,[r(y,{class:"w-full",text:"text-xs",value:((n=l==null?void 0:l.institution)==null?void 0:n.name)??"Sin registro"},null,8,["value"])]),o("td",Ne,[r(y,{text:"text-xs",value:l.email},null,8,["value"])])])}),128))]))])):(i(),b(G,{key:1}))])]),r(f,{label:"Cargar archivo PDF:",required:"",help:"Solo archivos PDF (MAX 100M)",error:a(e).errors.file},{default:_(()=>[o("div",Pe,[o("div",Se,[o("div",Be,[a(e)._method?(i(),b(d,{key:0,onInput:L,height:"h-10.5",type:"file"})):v("",!0)]),o("p",Ee,"Nombre del archivo: "+x($.value),1),o("p",Te,"Tamaño: "+x(q.value),1)]),o("div",je,[a(e).file||a(m).filePath?(i(),c("iframe",{key:0,class:"w-full h-96 border rounded-lg shadow-md",src:D.value},null,8,Ie)):v("",!0)])])]),_:1},8,["error"])],64))}};export{Je as default};
