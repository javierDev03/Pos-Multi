import{r as y,T as K,c as U,w as G,p as $,o as d,a as c,b as l,d as i,F as x,u as a,i as X,e as o,f as H,g as N,h as T,t as w,j as J,k as Q}from"./app-C8VQvZ0f.js";import{_ as W}from"./CardBox-D-3MIlS4.js";import{_ as Y}from"./LayoutMain-ZFijm9Gj.js";import{_ as Z}from"./SectionTitleLineWithButton-CORxjxXV.js";import{m as B,a as ee,b as le,c as te}from"./colors-CEsUPgXD.js";import{_ as v}from"./BaseButton-D751zZDp.js";import{_ as E}from"./BaseButtons-BYm_JhLH.js";import{_ as p}from"./FormField-bCdG-tNU.js";import{_ as m}from"./FormControl-haua1sQz.js";import{C as S}from"./CardBoxComponentEmpty-DJHEVF5S.js";import{_}from"./InputError-XlLNAwgH.js";import{V as ae,F as j}from"./flowbite-vue-WjY8nwBi.js";import oe from"./Card-BV-IljKE.js";import{_ as re}from"./Select-CVkdm-Ju.js";import{_ as se}from"./HeadLogo-BA8DlMdf.js";import{S as k}from"./sweetalert2.esm.all-BccGxJ0c.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./main-C82n4mBH.js";import"./BaseDivider-ugWBZYPJ.js";import"./_baseGetTag-zIT0YVv4.js";const ie={key:0,class:"h-[500px] py-5 overflow-auto justify-center gap-4 grid sm:grid-cols-2 lg:grid-cols-3 lg:gap-8"},ne={class:"md:flex md:space-x-4 my-5"},de={class:"md:w-1/2 max-lg:mb-5"},ue={class:"md:w-1/2"},me={class:"my-6"},ce={class:"flex justify-between items-start"},fe={class:"max-h-96 overflow-y-auto"},pe={key:0},_e={"data-label":"No"},ge={"data-label":"AC"},he=["checked","onChange"],be={"data-label":"Prefijo"},ye={"data-label":"Nombre(s)"},xe={"data-label":"Apellido(s)"},ve={"data-label":"Institución"},Ve={"data-label":"Email"},we={"data-label":"Acciones",class:"flex justify-center items-center space-x-2"},ke={class:"bg-slate-100 border-4 border-dashed border-gray-400 flex flex-col items-center justify-center rounded-lg shadow-lg p-6 md:p-10 mb-4 dark:bg-gray-800 dark:border-gray-600"},Ce={class:"w-auto mb-6 text-sm md:text-base font-medium text-gray-700 dark:text-gray-300"},Ae={class:"font-semibold mt-4"},Ue={class:"font-semibold"},$e={class:"w-full flex justify-center mt-8 mb-4"},Ne=["src"],Te={key:1,class:"text-slate-600 text-2xl"},We={__name:"Create",props:{name:"Create",title:{type:String,required:!0},routeName:{type:String,required:!0},areas:{type:Object,default:{},required:!0},calls:{type:Object,default:{},required:!0},callId:{default:null},articleTypes:{type:Array,required:!0}},setup(f){const h=f,q=h.areas.filter(s=>s.parent_id===null)??[],C=y([]),b=y("call"),V=y(null);y([]);const e=K({title:null,type:"Artículo (6 hojas)",abstract:null,key_works:null,knowledge_area_id:null,article_status_id:1,call_id:h.callId,file:null,authors:[],article_type_id:null,selectedArea:null}),A=()=>{e.post(route(`${h.routeName}store`),{onError:s=>{s.call_id?b.value="call":b.value="general"}})},F=s=>{Q.get(route("institution.filter",s)).then(r=>{V.value=r.data}).catch(function(r){r.response&&r.response.status==500&&k.fire({title:"ERRO!",text:"Error",icon:"info",confirmButtonColor:"#3085d6",confirmButtonText:"Ok!"})})},L=s=>{e.file=s.target.files[0]},D=U(()=>{if(e.file!==null)return URL.createObjectURL(e.file)}),I=[{id:"Doctor(a)",name:"Doctor(a)"},{id:"Maestro(a)",name:"Maestro(a)"},{id:"Ingeniero(a)",name:"Ingeniero(a)"},{id:"Licenciado(a)",name:"Licenciado(a)"},{id:"Profesor(a)",name:"Profesor(a)"},{id:"Estudiante(a)",name:"Estudiante(a)"}],P=()=>{if(e.authors.length>=6){k.fire({title:"ERROR!",text:"No se pueden agregar más de 6 autores",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"Ok!"});return}e.authors.push({id:Date.now(),is_corresponding:e.authors.length===0,prefix:null,name:null,surname:null,institution_id:null,email:null})},R=s=>{if(e.authors.length<=1){k.fire({title:"Ups!",text:"Debe haber al menos 1 autor",icon:"warning",confirmButtonColor:"#3085d6",confirmButtonText:"Ok"});return}const r=e.authors[s].is_corresponding;e.authors.splice(s,1),r&&e.authors.length>0&&(e.authors[0].is_corresponding=!0)},M=s=>{e.authors.forEach(r=>{r.is_corresponding=r.id===s})};U(()=>e.authors.find(s=>s.is_corresponding));const g=(s,r)=>{const t=`authors.${s}.${r}`;return e.errors[t]??null},O=()=>{e.knowledge_area_id=null,C.value=h.areas.filter(s=>s.parent_id===e.selectedArea)},z=s=>{var r;return s?(r=V.value)==null?void 0:r.find(t=>t.id===s):null};return G(()=>e.selectedArea,O),$("calls",h.calls),$("form",e),(s,r)=>(d(),c(x,null,[l(se,{title:f.title},null,8,["title"]),l(Y,null,{default:i(()=>[l(Z,{icon:a(B),title:f.title,main:""},{default:i(()=>[l(a(X),{href:s.route(`${f.routeName}index`)},{default:i(()=>r[7]||(r[7]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:"bi bi-x",viewBox:"0 0 16 16"},[o("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])),_:1},8,["href"])]),_:1},8,["icon","title"]),l(W,{isForm:"",onSubmit:H(A,["prevent"])},{footer:i(()=>[l(E,null,{default:i(()=>[l(v,{routeName:`${f.routeName}index`,icon:a(ee),color:"white",label:"Cancelar"},null,8,["routeName","icon"]),l(v,{onClick:A,icon:a(le),color:"success",label:"Guardar"},null,8,["icon"])]),_:1})]),default:i(()=>[l(a(ae),{modelValue:b.value,"onUpdate:modelValue":r[6]||(r[6]=t=>b.value=t),variant:"underline",class:"p-5"},{default:i(()=>[l(a(j),{name:"call",title:"Convocatoria",disabled:!1},{default:i(()=>[f.calls.length>0?(d(),c("div",ie,[(d(!0),c(x,null,N(f.calls,t=>(d(),c("div",{key:t.id,class:"mb-2"},[l(oe,{call:t},null,8,["call"])]))),128))])):(d(),T(S,{key:1})),l(_,{message:a(e).errors.call_id},null,8,["message"])]),_:1}),l(a(j),{name:"general",title:"Datos generales",disabled:!1},{default:i(()=>[l(p,{required:"",label:"Teclea el título del artículo en el idioma inglés:",error:a(e).errors.title},{default:i(()=>[l(m,{height:"h-12",modelValue:a(e).title,"onUpdate:modelValue":r[0]||(r[0]=t=>a(e).title=t),placeholder:"Teclea el título del artículo en el idioma inglés"},null,8,["modelValue"])]),_:1},8,["error"]),l(p,{required:"",label:"Selecciona un tipo de artículo",error:a(e).errors.article_type_id},{default:i(()=>[l(m,{modelValue:a(e).article_type_id,"onUpdate:modelValue":r[1]||(r[1]=t=>a(e).article_type_id=t),options:f.articleTypes,placeholder:"Selecciona un tipo",labelKey:"name",valueKey:"id"},null,8,["modelValue","options"])]),_:1},8,["error"]),l(p,{required:"",label:"Teclea tu resumen del artículo en el idioma inglés:",error:a(e).errors.abstract},{default:i(()=>[l(m,{type:"textarea",height:"h-56",modelValue:a(e).abstract,"onUpdate:modelValue":r[2]||(r[2]=t=>a(e).abstract=t),placeholder:"Teclea tu resumen del artículo en el idioma inglés"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",ne,[o("div",de,[l(p,{label:"Programas de Estudio:"},{default:i(()=>[l(m,{modelValue:a(e).selectedArea,"onUpdate:modelValue":r[3]||(r[3]=t=>a(e).selectedArea=t),options:a(q)},null,8,["modelValue","options"])]),_:1})]),o("div",ue,[l(p,{required:"",label:"Áreas Prioritarias:",error:a(e).errors.knowledge_area_id},{default:i(()=>[l(m,{modelValue:a(e).knowledge_area_id,"onUpdate:modelValue":r[4]||(r[4]=t=>a(e).knowledge_area_id=t),options:C.value},null,8,["modelValue","options"])]),_:1},8,["error"])])]),l(p,{required:"",label:"Teclea tus palabras clave en el idioma inglés:",error:a(e).errors.key_works},{default:i(()=>[l(m,{modelValue:a(e).key_works,"onUpdate:modelValue":r[5]||(r[5]=t=>a(e).key_works=t),placeholder:"Teclea tus palabras clave en el idioma inglés"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",me,[o("div",ce,[r[8]||(r[8]=o("div",{class:"flex flex-col"},[o("label",{class:"font-bold"},"Lista de autores"),o("label",{class:"font-normal text-sm text-blue-600 mt-1 italic"}," Recuerda marcar la casilla de verificación para el Autor Correspondencia (AC). ")],-1)),l(v,{icon:a(B),disabled:a(e).authors.length>=6,title:a(e).authors.length>=6?"Máximo 6 autores permitidos":"",onClick:P,label:"Agregar autor",color:"info"},null,8,["icon","disabled","title"])]),o("div",fe,[a(e).authors.length>0?(d(),c("table",pe,[r[9]||(r[9]=o("thead",null,[o("tr",null,[o("th",null,"No."),o("th",null,"AC"),o("th",null,"Prefijo"),o("th",null,"Nombre(s)"),o("th",null,"Apellido(s)"),o("th",null,"Institución"),o("th",null,"Email"),o("th",null,"Acciones")])],-1)),o("tbody",null,[(d(!0),c(x,null,N(a(e).authors,(t,n)=>(d(),c("tr",{key:n,class:"z-0"},[o("td",_e,w(n+1),1),o("td",ge,[o("input",{type:"radio",name:"corresponding-author",checked:t.is_corresponding,onChange:u=>M(t.id),class:"h-6 w-6 text-indigo-600"},null,40,he),l(_,{message:g(n,"is_corresponding")},null,8,["message"])]),o("td",be,[l(m,{modelValue:t.prefix,"onUpdate:modelValue":u=>t.prefix=u,options:I,height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),l(_,{message:g(n,"prefix")},null,8,["message"])]),o("td",ye,[l(m,{modelValue:t.name,"onUpdate:modelValue":u=>t.name=u,placeholder:"Nombre",height:"h-8",textClass:"tex-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(_,{message:g(n,"name")},null,8,["message"])]),o("td",xe,[l(m,{modelValue:t.surname,"onUpdate:modelValue":u=>t.surname=u,placeholder:"Apellido",height:"h-8",textClass:"tex-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(_,{message:g(n,"surname")},null,8,["message"])]),o("td",ve,[l(re,{placeholder:"Busca una institución",height:"h-8",modelValue:t.institution_id,"onUpdate:modelValue":u=>t.institution_id=u,required:"",options:V.value,onSearch:F,itemSelected:z(t.institution_id),dropdownClass:"p-2 relative w-full z-50 bg-white dark:bg-gray-800 dark:text-white border border-gray-300 mt-1 max-h-32 overflow-hidden overflow-y-scroll rounded-md shadow-md"},null,8,["modelValue","onUpdate:modelValue","options","itemSelected"]),l(_,{message:g(n,"institution_id")},null,8,["message"])]),o("td",Ve,[l(m,{modelValue:t.email,"onUpdate:modelValue":u=>t.email=u,placeholder:"Email",height:"h-8",textClass:"text-sm"},null,8,["modelValue","onUpdate:modelValue"]),l(_,{message:g(n,"email")},null,8,["message"])]),o("td",we,[l(E,null,{default:i(()=>[l(v,{icon:a(te),small:"",onClick:u=>R(n),color:"danger"},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])])):(d(),T(S,{key:1}))])]),l(p,{label:"Cargar archivo PDF:",required:"",help:"Solo archivos PDF (MAX 100M)",error:a(e).errors.file},{default:i(()=>{var t,n;return[o("div",ke,[o("div",Ce,[l(m,{onInput:L,height:"h-10.5",type:"file",class:"w-full"}),o("p",Ae," Nombre del archivo: "+w((t=a(e).file)==null?void 0:t.name),1),o("p",Ue," Tamaño: "+w((((n=a(e).file)==null?void 0:n.size)/1e3).toFixed(2))+" KB ",1)]),o("div",$e,[a(e).file?(d(),c(x,{key:0},[a(e).file.type==="application/pdf"?(d(),c("iframe",{key:0,class:"w-full h-96 border rounded-lg shadow-md",src:D.value},null,8,Ne)):(d(),c("span",Te,"Formato no disponible!"))],64)):J("",!0)])])]}),_:1},8,["error"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})],64))}};export{We as default};
