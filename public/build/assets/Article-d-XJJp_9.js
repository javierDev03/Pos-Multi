import{m as O,c as K}from"./colors-CEsUPgXD.js";import{_}from"./FormField-bCdG-tNU.js";import{_ as d}from"./FormControl-haua1sQz.js";import{C as Q}from"./CardBoxComponentEmpty-DJHEVF5S.js";import{_ as X}from"./BaseButtons-BYm_JhLH.js";import{_ as A}from"./BaseButton-D751zZDp.js";import{_ as h}from"./InputError-XlLNAwgH.js";import{_ as b}from"./LabelControl-m7hiFd44.js";import{x as P,Q as G,r as E,c as v,w as H,z as J,o as n,a as m,b as s,d as c,u as a,e as o,h as g,j as y,F as k,g as N,t as V,k as S}from"./app-C8VQvZ0f.js";import{_ as W}from"./Select-CVkdm-Ju.js";import{S as j}from"./sweetalert2.esm.all-BccGxJ0c.js";/* empty css                        */import"./main-C82n4mBH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_baseGetTag-zIT0YVv4.js";const Y={class:"md:flex md:space-x-4 my-5"},Z={class:"md:w-1/2 max-lg:mb-5"},ee={class:"md:w-1/2"},te={class:"my-6"},le={class:"justify-between flex mb-6"},oe={class:"max-h-96 overflow-y-auto overflow-x-auto"},ae={key:0,class:""},se={key:0},re={key:0},ie={"data-label":"No"},ne={"data-label":"AC"},de=["checked"],ue={"data-label":"Prefijo"},me={"data-label":"Nombre(s)"},ce={"data-label":"Apellido(s)"},pe={"data-label":"Institución"},_e={"data-label":"Email"},fe={"data-label":"Acciones"},he={key:1},be={"data-label":"No"},ge={"data-label":"AC"},xe=["checked"],ye={"data-label":"Prefijo"},Ve={"data-label":"Nombre(s)"},ve={"data-label":"Apellido(s)"},ke={"data-label":"Institución"},we={"data-label":"Email"},Ce={class:"bg-slate-100 border-4 border-dashed border-gray-400 flex flex-col items-center justify-center rounded-lg shadow-lg p-6 md:p-10 mb-4 dark:bg-gray-800 dark:border-gray-600"},Ue={class:"w-auto mb-6 text-sm md:text-base font-medium text-gray-700 dark:text-gray-300"},Ae={class:"flex justify-center space-x-2"},Pe={class:"font-semibold mt-4"},Ee={class:"font-semibold"},Ne={class:"w-full flex justify-center mt-8 mb-4"},Se=["src"],Ge={__name:"Article",setup(je){var U;const l=P("form"),B=G().props.articleTypes,p=P("props");l.article_type_id=l.article_type_id??((U=p.article)==null?void 0:U.article_type_id)??null;const I=p.areas.filter(r=>r.parent_id===null)??[],w=E([]),x=E(p.institutions),$=v(()=>{var r,e;return((r=l.file)==null?void 0:r.name)??((e=p.article.file)==null?void 0:e.name)??"Sin archivo"}),T=v(()=>{var r,e;return((((r=l.file)==null?void 0:r.size)??((e=p.article.file)==null?void 0:e.size))/1e3).toFixed(2)+" KB"}),q=r=>{l.file=r.target.files[0]},D=v(()=>l.file?URL.createObjectURL(l.file):p.filePath),F=[{id:"Doctor(a)",name:"Doctor(a)"},{id:"Maestro(a)",name:"Maestro(a)"},{id:"Ingeniero(a)",name:"Ingeniero(a)"},{id:"Licenciado(a)",name:"Licenciado(a)"},{id:"Profesor(a)",name:"Profesor(a)"},{id:"Estudiante(a)",name:"Estudiante(a)"}],L=()=>{l.authors.push({is_corresponding:!1,prefix:null,name:null,surname:null,institution_id:null,email:null})},R=(r,e)=>{l.authors.length>0&&(e?S.delete(route("author.destroy",e)).then(t=>{t.status===200&&l.authors.splice(r,1)}).catch(t=>{t.response.status===500&&j.fire({title:"Error",text:"Se produjo un error al eliminar el autor.",icon:"error",confirmButtonColor:"#3085d6",confirmButtonText:"Ok"})}):l.authors.splice(r,1))},f=(r,e)=>{const t=`authors.${r}.${e}`;return l.errors[t]??null},C=()=>{var r,e;l.selectedArea!==((e=(r=p.article)==null?void 0:r.knowledge_area)==null?void 0:e.parent_id)&&(l.knowledge_area_id=null),w.value=p.areas.filter(t=>t.parent_id===l.selectedArea)},M=r=>{S.get(route("institution.filter",r)).then(e=>{x.value=e.data,console.log(x)}).catch(function(e){e.response&&e.response.status==500&&j.fire({title:"ERRO!",text:"Error",icon:"info",confirmButtonColor:"#3085d6",confirmButtonText:"Ok!"})})},z=r=>{var e;return r?(e=x.value)==null?void 0:e.find(t=>t.id===r):null};return H(()=>l.selectedArea,C),J(()=>{C()}),(r,e)=>(n(),m(k,null,[s(_,{required:"",label:"Titulo:",error:a(l).errors.title},{default:c(()=>[s(d,{height:"h-12",modelValue:a(l).title,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).title=t),placeholder:"Titulo"},null,8,["modelValue"])]),_:1},8,["error"]),s(_,{required:"",label:"Tipo de artículo:",error:a(l).errors.article_type_id},{default:c(()=>[s(d,{options:a(B),modelValue:a(l).article_type_id,"onUpdate:modelValue":e[1]||(e[1]=t=>a(l).article_type_id=t),"option-label":"name","option-value":"id",placeholder:"Selecciona un tipo"},null,8,["options","modelValue"])]),_:1},8,["error"]),s(_,{required:"",label:"Resumen:",error:a(l).errors.abstract},{default:c(()=>[s(d,{type:"textarea",height:"h-56",modelValue:a(l).abstract,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).abstract=t),placeholder:"Resumen"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",Y,[o("div",Z,[s(_,{label:"Programa de estudio:"},{default:c(()=>[s(d,{modelValue:a(l).selectedArea,"onUpdate:modelValue":e[3]||(e[3]=t=>a(l).selectedArea=t),options:a(I)},null,8,["modelValue","options"])]),_:1})]),o("div",ee,[s(_,{required:"",label:"Área Prioritaria:",error:a(l).errors.knowledge_area_id},{default:c(()=>[s(d,{modelValue:a(l).knowledge_area_id,"onUpdate:modelValue":e[4]||(e[4]=t=>a(l).knowledge_area_id=t),options:w.value},null,8,["modelValue","options"])]),_:1},8,["error"])])]),s(_,{required:"",label:"Convocatoria:",error:a(l).errors.call_id},{default:c(()=>[s(d,{disabled:"",modelValue:a(l).call,"onUpdate:modelValue":e[5]||(e[5]=t=>a(l).call=t),placeholder:"Convocatoria"},null,8,["modelValue"])]),_:1},8,["error"]),s(_,{required:"",label:"Palabras clave:",error:a(l).errors.key_works},{default:c(()=>[s(d,{modelValue:a(l).key_works,"onUpdate:modelValue":e[6]||(e[6]=t=>a(l).key_works=t),placeholder:"Palabras clave"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",te,[o("div",le,[e[7]||(e[7]=o("label",{class:"font-bold"},"Lista de autores",-1)),a(l)._method?(n(),g(A,{key:0,icon:a(O),onClick:L,label:"Agregar autor",color:"info"},null,8,["icon"])):y("",!0)]),o("div",oe,[a(l).authors.length>0?(n(),m("table",ae,[o("thead",null,[o("tr",null,[e[8]||(e[8]=o("th",null,"No.",-1)),e[9]||(e[9]=o("th",null,"AC",-1)),e[10]||(e[10]=o("th",null,"Prefijo",-1)),e[11]||(e[11]=o("th",null,"Nombre(s)",-1)),e[12]||(e[12]=o("th",null,"Apellido(s)",-1)),e[13]||(e[13]=o("th",null,"Institución",-1)),e[14]||(e[14]=o("th",null,"Email",-1)),a(l)._method?(n(),m("th",se,"Acciones")):y("",!0)])]),a(l)._method?(n(),m("tbody",re,[(n(!0),m(k,null,N(a(l).authors,(t,u)=>(n(),m("tr",{key:u},[o("td",ie,V(u+1),1),o("td",ne,[o("input",{type:"radio",name:"corresponding-author",checked:t.is_corresponding,class:"h-6 w-6 text-indigo-600"},null,8,de),s(h,{message:f(u,"prefix")},null,8,["message"])]),o("td",ue,[s(d,{modelValue:t.prefix,"onUpdate:modelValue":i=>t.prefix=i,options:F,height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),s(h,{message:f(u,"prefix")},null,8,["message"])]),o("td",me,[s(d,{modelValue:t.name,"onUpdate:modelValue":i=>t.name=i,placeholder:"Nombre",height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),s(h,{message:f(u,"name")},null,8,["message"])]),o("td",ce,[s(d,{modelValue:t.surname,"onUpdate:modelValue":i=>t.surname=i,placeholder:"Apellido",height:"h-8",textClass:"tex-sm"},null,8,["modelValue","onUpdate:modelValue"]),s(h,{message:f(u,"surname")},null,8,["message"])]),o("td",pe,[a(l)._method?(n(),g(_,{key:0,error:f(u,"institution_id"),textClass:"text-sm",class:"dark:text-white"},{default:c(()=>[s(W,{disabled:!a(l)._method,itemSelected:z(t.institution_id),placeholder:"Busca una institución",height:"h-8",modelValue:t.institution_id,"onUpdate:modelValue":i=>t.institution_id=i,required:"",options:x.value,onSearch:M,dropdownClass:"p-2 relative w-full z-50 bg-white dark:bg-gray-800 dark:text-white border border-gray-300 mt-1 max-h-32 overflow-hidden overflow-y-scroll rounded-md shadow-md"},null,8,["disabled","itemSelected","modelValue","onUpdate:modelValue","options"])]),_:2},1032,["error"])):(n(),g(d,{key:1,modelValue:t.institution.name,"onUpdate:modelValue":i=>t.institution.name=i,placeholder:"Institucion",height:"h-8",textClass:"tex-sm"},null,8,["modelValue","onUpdate:modelValue"]))]),o("td",_e,[s(d,{type:"email",modelValue:t.email,"onUpdate:modelValue":i=>t.email=i,placeholder:"Email",height:"h-8",textClass:"tex-xs"},null,8,["modelValue","onUpdate:modelValue"]),s(h,{message:f(u,"email")},null,8,["message"])]),o("td",fe,[s(X,null,{default:c(()=>[s(A,{icon:a(K),small:"",onClick:i=>R(u,t==null?void 0:t.id),color:"danger"},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])):(n(),m("tbody",he,[(n(!0),m(k,null,N(a(l).authors,(t,u)=>{var i;return n(),m("tr",{key:u},[o("td",be,V(u+1),1),o("td",ge,[o("input",{type:"radio",name:"corresponding-author",checked:t.is_corresponding,class:"h-6 w-6 text-indigo-600"},null,8,xe)]),o("td",ye,[s(b,{text:"text-xs",value:t.prefix},null,8,["value"])]),o("td",Ve,[s(b,{text:"text-xs",value:t.name},null,8,["value"])]),o("td",ve,[s(b,{text:"text-xs",value:t.surname},null,8,["value"])]),o("td",ke,[s(b,{class:"w-full",text:"text-xs",value:((i=t==null?void 0:t.institution)==null?void 0:i.name)??"Sin registro"},null,8,["value"])]),o("td",we,[s(b,{text:"text-xs",value:t.email},null,8,["value"])])])}),128))]))])):(n(),g(Q,{key:1}))])]),s(_,{label:"Cargar archivo PDF:",required:"",help:"Solo archivos PDF (MAX 100M)",error:a(l).errors.file},{default:c(()=>[o("div",Ce,[o("div",Ue,[o("div",Ae,[a(l)._method?(n(),g(d,{key:0,onInput:q,height:"h-10.5",type:"file"})):y("",!0)]),o("p",Pe,"Nombre del archivo: "+V($.value),1),o("p",Ee,"Tamaño: "+V(T.value),1)]),o("div",Ne,[a(l).file||a(p).filePath?(n(),m("iframe",{key:0,class:"w-full h-96 border rounded-lg shadow-md",src:D.value},null,8,Se)):y("",!0)])])]),_:1},8,["error"])],64))}};export{Ge as default};
